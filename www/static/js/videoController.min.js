var FactoryMediaController=function(){};FactoryMediaController.prototype.constructor=FactoryMediaController;FactoryMediaController.prototype.getNewMediaController=function(a){return document.webkitFullscreenEnabled?new WebkitMediaController(a):document.mozFullScreenEnabled?new GeckoMediaController(a):document.msFullscreenEnabled?new IEMediaController(a):new GenericMediaController(a)};
function GenericMediaController(a){this.id=a;this.media=document.getElementById(a);this.$media=$(this.media);this.$media.is("video")?this.type="video":this.$media.is("audio")&&(this.type="audio");this.engine="unknown";this.controls={};this.controls.override={};this.components=[];this.setEvents();debug&&console.log(this)}GenericMediaController.prototype.constructor=GenericMediaController;GenericMediaController.prototype.stop=function(){this.media.pause();this.media.currentTime=0};
GenericMediaController.prototype.play=function(){this.isPlaying()||this.media.play()};GenericMediaController.prototype.mute=function(){this.isMuted()?(volume=document.querySelector(this.controls.volume).value,this.setVolume(parseFloat(volume))):this.setVolume(0)};GenericMediaController.prototype.pause=function(){this.isPlaying()&&this.media.pause()};GenericMediaController.prototype.toString=function(){return this.media.toString()+this.engine};
GenericMediaController.prototype.isMuted=function(){return 0==this.media.volume};GenericMediaController.prototype.isPlaying=function(){return!this.media.paused};GenericMediaController.prototype.isFullscreen=function(){return this.container===document.fullscreenElement};GenericMediaController.prototype.hasAutoPlay=function(){return void 0!=this.$media.attr("autoplay")};GenericMediaController.prototype.getSize=function(){return[this.getHeight(),this.getWidth()]};
GenericMediaController.prototype.getWidth=function(){var a=this.$media.css("width"),c=this.$media.css("border-left-width"),d=this.$media.css("border-right-width"),b=this.$media.css("padding-left"),f=this.$media.css("padding-right"),e=this.$media.css("margin-left"),g=this.$media.css("margin-right"),a=parseInt(a.substr(0,a.indexOf("px"))),c=c.substr(0,c.indexOf("px")),d=d.substr(0,d.indexOf("px")),b=b.substr(0,b.indexOf("px")),f=f.substr(0,f.indexOf("px")),e=e.substr(0,e.indexOf("px")),g=g.substr(0,
g.indexOf("px")),c=parseInt(d)+parseInt(c),b=parseInt(f)+parseInt(b),e=parseInt(g)+parseInt(e);return a+e+b+c};
GenericMediaController.prototype.getHeight=function(){var a=this.$media.css("height"),c=this.$media.css("border-top-width"),d=this.$media.css("border-bottom-width"),b=this.$media.css("padding-top"),f=this.$media.css("padding-bottom"),e=this.$media.css("margin-top"),g=this.$media.css("margin-bottom"),a=parseInt(a.substr(0,a.indexOf("px"))),c=c.substr(0,c.indexOf("px")),d=d.substr(0,d.indexOf("px")),b=b.substr(0,b.indexOf("px")),f=f.substr(0,f.indexOf("px")),e=e.substr(0,e.indexOf("px")),g=g.substr(0,
g.indexOf("px")),c=parseInt(d)+parseInt(c),b=parseInt(f)+parseInt(b),e=parseInt(g)+parseInt(e);return a+e+b+c};GenericMediaController.prototype.getDuration=function(){return this.media.duration};GenericMediaController.prototype.getCurrentTime=function(){return this.media.currentTime};
GenericMediaController.prototype.getStringTime=function(){var a=parseInt(this.getCurrentTime()),c=Math.floor(a/3600),a=a-3600*c,d=Math.floor(a/60),a=a-60*d,b="",b=10>d?b+(0+d.toString()):b+d.toString(),b=10>a?b+(":0"+a.toString()):b+(":"+a.toString());0<c&&(b=c+":"+b);return b};GenericMediaController.prototype.setTime=function(a){this.media.currentTime=a};
GenericMediaController.prototype.setEvents=function(){var a=this;if(!this.controls.override.play)this.$media.on("play",function(c){$(a.controls.play).hide();$(a.controls.pause).show()});if(!this.controls.override.pause)this.$media.on("pause",function(c){$(a.controls.play).show();$(a.controls.pause).hide()});if(!this.controls.override.volume)this.$media.on("volumechange",function(c){0==a.media.volume?($(a.controls.mute).children().hide(),$(a.controls.mute).children(".no-volume").show()):0<a.media.volume&&
1>a.media.volume?($(a.controls.mute).children().hide(),$(a.controls.mute).children(".half-volume").show()):($(a.controls.mute).children().hide(),$(a.controls.mute).children(".high-volume").show())});this.$media.on("timeupdate",function(c){a.controls.seekBar&&$(a.controls.seekBar).val(a.getCurrentTime()/a.getDuration());a.controls.timer&&(a.getStringTime(),$(a.controls.timer).text(a.getStringTime()))})};GenericMediaController.prototype.setVolume=function(a){this.media.volume=a};
GenericMediaController.prototype.setContainer=function(a){this.container=document.querySelector(a);this.$container=$(a)};GenericMediaController.prototype.setFullScreen=function(){document.fullscreenEnabled?(this.container.requestFullscreen(),this.$container.css("background-color","black"),this.$container.addClass("fullscreen")):this.$media.addClass("fullscreen")};GenericMediaController.prototype.exitFullScreen=function(){document.fullscreenEnabled?document.exitFullscreen():this.$media.removeClass("fullscreen")};
GenericMediaController.prototype.addControl=function(a,c,d){d=void 0===d?!1:d;if($(a)){var b=this;switch(c){case "play":$(a).click(function(){b.play()});this.controls.play=a;this.controls.override.play=d;this.hasAutoPlay()&&$(this.controls.play).hide();break;case "pause":$(a).click(function(){b.pause()});this.hasAutoPlay()||$(this.controls.pause).hide();this.controls.pause=a;this.controls.override.pause=d;break;case "stop":$(a).click(function(){b.stop()});this.controls.stop=a;break;case "seekBar":$(a).on("mousedown",
function(a){b.isPlaying()&&$(this).data("replay",!0);b.pause()});$(a).on("mouseup",function(a){$(this).data("replay")&&b.play()});$(a).on("change",function(a){b.setTime(b.getDuration()*this.value)});this.controls.seekBar=a;break;case "timer":this.controls.timer=a;break;case "fullscreen":$(a).click(function(){b.isFullscreen()?b.exitFullScreen():b.setFullScreen()});this.controls.fullscreen=a;this.controls.override.fullscreen=d;break;case "mute":$(a).click(function(){b.mute()});this.controls.mute=a;
this.controls.override.mute=d;d||($(this.controls.mute).children().hide(),$(this.controls.mute).children(".high-volume").show());break;case "volume":$(a).on("change",function(a){b.setVolume(this.value)}),volume=document.querySelector(a).value,this.setVolume(parseFloat(volume)),this.controls.volume=a}}};GenericMediaController.prototype.addComponent=function(a){};function WebkitMediaController(a){GenericMediaController.call(this,a);this.engine="webkit"}WebkitMediaController.prototype=Object.create(GenericMediaController.prototype);
WebkitMediaController.prototype.setFullScreen=function(){this.container.webkitRequestFullScreen();this.$container.addClass("fullscreen")};WebkitMediaController.prototype.exitFullScreen=function(){document.webkitExitFullscreen();this.$container.removeClass("fullscreen")};WebkitMediaController.prototype.isFullscreen=function(){return this.container===document.webkitFullscreenElement};function GeckoMediaController(a){GenericMediaController.call(this,a);this.engine="Gecko"}
GeckoMediaController.prototype=Object.create(GenericMediaController.prototype);GeckoMediaController.prototype.setFullScreen=function(){this.container.mozRequestFullScreen();this.$container.addClass("fullscreen")};GeckoMediaController.prototype.exitFullScreen=function(){document.mozCancelFullScreen();this.$container.removeClass("fullscreen")};GeckoMediaController.prototype.isFullscreen=function(){return this.container===document.mozFullScreenElement};
function IEMediaController(a){GenericMediaController.call(this,a);this.engine="MS"}IEMediaController.prototype=Object.create(GenericMediaController.prototype);IEMediaController.prototype.setFullScreen=function(){this.container.msRequestFullscreen();this.$container.addClass("fullscreen")};IEMediaController.prototype.exitFullScreen=function(){document.msExitFullscreen();this.$container.css("background-color","black")};IEMediaController.prototype.isFullscreen=function(){return this.container===document.msFullscreenElement};
window.Factory=new FactoryMediaController;
